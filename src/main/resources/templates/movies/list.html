<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="da">
<head>
    <meta charset="UTF-8">
    <title>Film</title>
    <link rel="stylesheet" th:href="@{/css/theme.css}">
    <link rel="stylesheet" th:href="@{/css/utilities.css}">
    <link rel="stylesheet" th:href="@{/css/global.css}">
</head>
<body class="movies">
<header class="topbar">
    <div class="brand">KinoXP</div>
    <nav class="tabs">
        <a class="tab" th:href="@{/}">Forside</a>
        <a class="tab" th:href="@{/screenings}">Billetter</a>
        <a class="tab" th:href="@{/movies}">Ret i film</a>
        <a class="tab" th:href="@{/mad-drikke}">Mad / Drikke</a>
        <a class="tab" th:href="@{/kalender}">Kalender</a>
        <a class="tab admin" th:href="@{/vagtplan}">Vagtplan</a>
    </nav>
    <div class="auth">
        <span>Bruger: X</span>
        <a class="btn" href="#">Log ind/ud</a>
    </div>
</header>

<main>
    <h1>Film</h1>

    <!-- Flash-besked -->
    <div th:if="${msg}"
         style="background:#eefbea;border:1px solid #9bd18e;padding:10px;margin-bottom:12px;"
         th:text="${msg}"></div>

    <p><a th:href="@{/movies/ny}">➕ Ny film</a></p>

    <!-- Aktuelle film -->
    <h2>Aktuelle film (d. <span th:text="${today}">i dag</span>)</h2>
    <p th:if="${#lists.isEmpty(activeMovies)}">Ingen aktuelle film.</p>

    <table th:if="${!#lists.isEmpty(activeMovies)}" class="table">
        <thead>
        <tr>
            <th>Titel</th>
            <th>Genre</th>
            <th>Periode</th>
            <th>Pris</th>
            <th>Handling</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="m : ${activeMovies}">
            <td th:text="${m.movieTitle}">Titel</td>
            <td th:text="${m.genre}">GENRE</td>
            <td>
                <span th:text="${m.premiereDate != null ? #temporals.format(m.premiereDate, 'yyyy-MM-dd') : '—'}">—</span>
                –
                <span th:text="${m.endDate != null ? #temporals.format(m.endDate, 'yyyy-MM-dd') : '—'}">—</span>
            </td>
            <td th:text="${m.price}">0</td>
            <td>
                <a th:href="@{/movies/{id}/rediger(id=${m.id})}">Rediger</a>
                &nbsp;|&nbsp;
                <form th:action="@{/movies/{id}/slet(id=${m.id})}" method="post" style="display:inline">
                    <!-- Hvis du bruger Spring Security, fjern kommentaren herunder -->
                    <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"> -->
                    <button type="submit">Slet</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Øvrige film -->
    <h2 style="margin-top:24px;">Andre film</h2>
    <p th:if="${#lists.isEmpty(otherMovies)}">Ingen øvrige film.</p>

    <table th:if="${!#lists.isEmpty(otherMovies)}" class="table">
        <thead>
        <tr>
            <th>Titel</th>
            <th>Genre</th>
            <th>Periode</th>
            <th>Pris</th>
            <th>Handling</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="m : ${otherMovies}">
            <td th:text="${m.movieTitle}">Titel</td>
            <td th:text="${m.genre}">GENRE</td>
            <td>
                <span th:text="${m.premiereDate != null ? #temporals.format(m.premiereDate, 'yyyy-MM-dd') : '—'}">—</span>
                –
                <span th:text="${m.endDate != null ? #temporals.format(m.endDate, 'yyyy-MM-dd') : '—'}">—</span>
            </td>
            <td th:text="${m.price}">0</td>
            <td>
                <a th:href="@{/movies/{id}/rediger(id=${m.id})}">Rediger</a>
                &nbsp;|&nbsp;
                <form th:action="@{/movies/{id}/slet(id=${m.id})}" method="post" style="display:inline">
                    <button type="submit">Slet</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</main>
</body>
</html>
